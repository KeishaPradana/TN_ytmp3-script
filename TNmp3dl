#!/data/data/com.termux/files/usr/bin/bash

green='\e[1;32m'
red='\e[0;31m'
reset='\e[0m'

link="$1"

if [[ -z "$link" ]]; then
    echo -e "${red}âš ï¸ Harap masukkan link YouTube sebagai argumen!${reset}"
    echo -e "${green}Contoh: TNmp3dl \"https://youtube.com/watch?v=xxxx\"${reset}"
    exit 1
fi

if [[ "$link" == *"list="* && "$link" != *"watch?v="* ]]; then
    echo -e "${green}ğŸ“œ Mendeteksi playlist...${reset}"
    yt-dlp -x --audio-format mp3 -P "$link"

elif [[ "$link" == *"watch?v="* && "$link" == *"list="* ]]; then
    echo -e "${green}ğŸµ Mendeteksi video dari playlist...${reset}"
    video_only=$(echo "$link" | grep -oP 'watch\?v=[^&]*')
    yt-dlp -x --audio-format mp3 -P "https://www.youtube.com/$video_only"

elif [[ "$link" == *"watch?v="* ]]; then
    echo -e "${green}ğŸµ Mendeteksi video tunggal...${reset}"
    yt-dlp -x --audio-format mp3 -P "$link"

else
    echo -e "${red}âŒ Link tidak valid atau tidak dikenali.${reset}"
fi

echo -e "${green}âœ… Selesai!${reset}"
